schema =  """
jobidentifier STRING,
analysisidentifier STRING,
data ARRAY<STRUCT<
    type STRING,
    instrumentreference STRUCT<
        analysisidentifier STRING,
        instrumentidentifier STRING,
        asofdate STRING,
        accountidentifier STRING,
        accountname STRING,
        instrumentname STRING,
        description STRING,
        instrumenttype STRING,
        instrumentsubtype STRING,
        consumerproductcategory STRING,
        originationdate STRING,
        maturitydate STRING,
        amortizationtype STRING,
        amortizationenddate STRING,
        isinterestonly STRING,
        cashflowtype STRING,
        instrumentcurrency STRING,
        notionalportion DOUBLE,
        unpaidprincipalbalance STRING,
        currentcommitmentamount DOUBLE,
        marketpriceoverride STRING,
        fixedpaymentamount DOUBLE,
        currentbookpriceoverride STRING,
        interestratetype STRING,
        interestpaymentfrequency STRING,
        curerate DOUBLE,
        fixedrate DOUBLE,
        currentrate DOUBLE,
        portfolioidentifier STRING,
        interestratespread DOUBLE,
        interestrateindexmultiplier DOUBLE,
        interestrateindex STRING,
        lifetimeinterestratecap DOUBLE,
        lifetimeinterestratefloor DOUBLE,
        periodicinterestratecap DOUBLE,
        periodicratefloor DOUBLE,
        interestrateresetfirstdate STRING,
        interestrateresetfrequency STRING,
        daycount STRING,
        optionadjustedspreadoverride DOUBLE,
        modified STRING,
        parmarketprice DOUBLE,
        servicingspread DOUBLE,
        company STRING,
        discountcurve STRING,
        accountside STRING,
        jobidentifier STRING,
        cashfloworder LONG,
        cashflowsource STRING,
        cashflowmodelname STRING,
        prepaymentorder LONG,
        prepaymentsource STRING,
        prepaymentmodelname STRING,
        prepaymentshift DOUBLE,
        prepaymentscalingfactor DOUBLE
    >,
    instrumentriskmetric ARRAY<STRUCT<
        analysisidentifier STRING,
        reportingdate STRING,
        inputscenarioidentifier STRING,
        instrumentidentifier STRING,
        scenarioidentifier STRING,
        modelname STRING,
        modeloutput STRING,
        asofdate STRING,
        term DOUBLE,
        timesegment STRING,
        annualizedcumulativepd DOUBLE,
        forwardpd DOUBLE,
        cumulativepd DOUBLE,
        marginalpd DOUBLE,
        maturityriskpd DOUBLE,
        maturityriskel DOUBLE,
        lgd DOUBLE,
        maturityrisklgd DOUBLE,
        lossrateannualized DOUBLE,
        lossratecumulative DOUBLE,
        ead DOUBLE,
        ccf DOUBLE,
        ugd DOUBLE,
        prepaymentrate DOUBLE,
        forwardprepaymentrate DOUBLE,
        cumulativeprepaymentrate DOUBLE,
        recovery DOUBLE,
        netchargeoff DOUBLE,
        annualizedpdoneyearprojection DOUBLE,
        stage1conditionalannualizedcumulativepd DOUBLE,
        stage2conditionalannualizedcumulativepd DOUBLE,
        stage3conditionalannualizedcumulativepd DOUBLE,
        impliedstagerating STRING,
        netchargeoffamount DOUBLE,
        collateralvalue DOUBLE,
        expectedcreditlossamount DOUBLE,
        expectedcreditlossamountlifetimeprojection DOUBLE,
        expectedcreditlossamountoneyearprojection DOUBLE,
        exposure DOUBLE,
        grossinterestincome DOUBLE,
        totalinterestexpense DOUBLE,
        riskweightedassets DOUBLE,
        stage1portion DOUBLE,
        stage2portion DOUBLE,
        stage3portion DOUBLE,
        transitionprobabilityfromstage1tostage2 DOUBLE,
        transitionprobabilityfromstage1tostage3 DOUBLE,
        transitionprobabilityfromstage2tostage1 DOUBLE,
        transitionprobabilityfromstage2tostage3 DOUBLE,
        transitionprobabilityfromstage3tostage2 DOUBLE,
        balancegrowthrate DOUBLE,
        lgdvariance DOUBLE,
        transactionsequence LONG,
        creditotherthantemporaryimpairment DOUBLE,
        noncreditotherthantemporaryimpairment DOUBLE,
        temporaryimpairment DOUBLE,
        othercomprehensiveincome DOUBLE,
        otherthantemporaryimpairmentprobability DOUBLE,
        jobidentifier STRING,
        valuedate STRING,
        decayrate DOUBLE,
        rateresponserate DOUBLE,
        usagerate DOUBLE,
        liquidityhaircut DOUBLE,
        singlemonthlymortalityrate DOUBLE,
        edfimpliedrating STRING,
        optionarmminimumpaymentportion DOUBLE,
        optionarminterestonlyportion DOUBLE,
        optionarmprincipalandinterestportion DOUBLE,
        forbearanceportion DOUBLE,
        forwarddecayrate DOUBLE
    >>,
    instrumentcashflow STRING,
    instrumenttimebucketmeasures STRING,
    instrumenterror ARRAY<STRUCT<
        analysisidentifier STRING,
        jobidentifier STRING,
        instrumentidentifier STRING,
        errorcode LONG,
        errormessage STRING,
        modulecode LONG,
        asofdate STRING,
        scenarioidentifier STRING,
        severity STRING,
        portfolioidentifier STRING
    >>,
    accounttimebucketmeasures STRING,
    accountcashflow STRING
>>
"""

instrument_ref_schema = """
        analysisidentifier STRING,
        instrumentidentifier STRING,
        asofdate STRING,
        accountidentifier STRING,
        accountname STRING,
        instrumentname STRING,
        description STRING,
        instrumenttype STRING,
        instrumentsubtype STRING,
        consumerproductcategory STRING,
        originationdate STRING,
        maturitydate STRING,
        amortizationtype STRING,
        amortizationenddate STRING,
        isinterestonly STRING,
        cashflowtype STRING,
        instrumentcurrency STRING,
        notionalportion DOUBLE,
        unpaidprincipalbalance STRING,
        currentcommitmentamount DOUBLE,
        marketpriceoverride STRING,
        fixedpaymentamount DOUBLE,
        currentbookpriceoverride STRING,
        interestratetype STRING,
        interestpaymentfrequency STRING,
        curerate DOUBLE,
        fixedrate DOUBLE,
        currentrate DOUBLE,
        portfolioidentifier STRING,
        interestratespread DOUBLE,
        interestrateindexmultiplier DOUBLE,
        interestrateindex STRING,
        lifetimeinterestratecap DOUBLE,
        lifetimeinterestratefloor DOUBLE,
        periodicinterestratecap DOUBLE,
        periodicratefloor DOUBLE,
        interestrateresetfirstdate STRING,
        interestrateresetfrequency STRING,
        daycount STRING,
        optionadjustedspreadoverride DOUBLE,
        modified STRING,
        parmarketprice DOUBLE,
        servicingspread DOUBLE,
        company STRING,
        discountcurve STRING,
        accountside STRING,
        jobidentifier STRING,
        cashfloworder LONG,
        cashflowsource STRING,
        cashflowmodelname STRING,
        prepaymentorder LONG,
        prepaymentsource STRING,
        prepaymentmodelname STRING,
        prepaymentshift DOUBLE,
        prepaymentscalingfactor DOUBLE
 """

instrument_error_schema = """
    analysisidentifier STRING,
    jobidentifier STRING,
    instrumentidentifier STRING,
    errorcode LONG,
    errormessage STRING,
    modulecode LONG,
    asofdate STRING,
    scenarioidentifier STRING,
    severity STRING,
    portfolioidentifier STRING"""

instrument_risk_schema = """
        analysisidentifier STRING,
        reportingdate STRING,
        inputscenarioidentifier STRING,
        instrumentidentifier STRING,
        scenarioidentifier STRING,
        modelname STRING,
        modeloutput STRING,
        asofdate STRING,
        term DOUBLE,
        timesegment STRING,
        annualizedcumulativepd DOUBLE,
        forwardpd DOUBLE,
        cumulativepd DOUBLE,
        marginalpd DOUBLE,
        maturityriskpd DOUBLE,
        maturityriskel DOUBLE,
        lgd DOUBLE,
        maturityrisklgd DOUBLE,
        lossrateannualized DOUBLE,
        lossratecumulative DOUBLE,
        ead DOUBLE,
        ccf DOUBLE,
        ugd DOUBLE,
        prepaymentrate DOUBLE,
        forwardprepaymentrate DOUBLE,
        cumulativeprepaymentrate DOUBLE,
        recovery DOUBLE,
        netchargeoff DOUBLE,
        annualizedpdoneyearprojection DOUBLE,
        stage1conditionalannualizedcumulativepd DOUBLE,
        stage2conditionalannualizedcumulativepd DOUBLE,
        stage3conditionalannualizedcumulativepd DOUBLE,
        impliedstagerating STRING,
        netchargeoffamount DOUBLE,
        collateralvalue DOUBLE,
        expectedcreditlossamount DOUBLE,
        expectedcreditlossamountlifetimeprojection DOUBLE,
        expectedcreditlossamountoneyearprojection DOUBLE,
        exposure DOUBLE,
        grossinterestincome DOUBLE,
        totalinterestexpense DOUBLE,
        riskweightedassets DOUBLE,
        stage1portion DOUBLE,
        stage2portion DOUBLE,
        stage3portion DOUBLE,
        transitionprobabilityfromstage1tostage2 DOUBLE,
        transitionprobabilityfromstage1tostage3 DOUBLE,
        transitionprobabilityfromstage2tostage1 DOUBLE,
        transitionprobabilityfromstage2tostage3 DOUBLE,
        transitionprobabilityfromstage3tostage2 DOUBLE,
        balancegrowthrate DOUBLE,
        lgdvariance DOUBLE,
        transactionsequence LONG,
        creditotherthantemporaryimpairment DOUBLE,
        noncreditotherthantemporaryimpairment DOUBLE,
        temporaryimpairment DOUBLE,
        othercomprehensiveincome DOUBLE,
        otherthantemporaryimpairmentprobability DOUBLE,
        jobidentifier STRING,
        valuedate STRING,
        decayrate DOUBLE,
        rateresponserate DOUBLE,
        usagerate DOUBLE,
        liquidityhaircut DOUBLE,
        singlemonthlymortalityrate DOUBLE,
        edfimpliedrating STRING,
        optionarmminimumpaymentportion DOUBLE,
        optionarminterestonlyportion DOUBLE,
        optionarmprincipalandinterestportion DOUBLE,
        forbearanceportion DOUBLE,
        forwarddecayrate DOUBLE
        """